---
title: 08 | 栈：如何实现浏览器的前进和后退功能？
tags: 栈,顺序栈,链式栈,函数调用栈,表达式求值,括号匹配,浏览器后退
renderNumberedHeading: true
grammar_cjkRuby: true
---

Author:  Qiao My
Create_Time: 2020-2-29

[toc]


# 一、栈 介绍

**`栈`是一种“操作受限”的线性表**，只允许咋一端插入(`入栈push()`)和删除(`出栈pop()`)数据

典型特点：后进者先出，先进者后出

相对数组和链表，栈 的操作接口暴露更少，操作缺少灵活自由，但使用时也具有更高的可控性，更不容易出错。

**当某个数据集合只涉及在一端插入和删除数据，并且满足 后进先出，先进后出的特性，应该首选“栈”这种数据结构**


# 二、栈的实现
栈既可以用数组实现，也可以同链表来实现。

**顺序栈**：用数组实现的栈
**链式栈**：用链表实现的栈

无论入栈、出栈，只需要一两个临时变量存储空间，所以空间复杂度为 O(1)。
无论入栈、出栈，只涉及栈顶个别数据的操作，所以时间复杂度都是 O(1)。

> 算法的 空间复杂度，是指除了原本的数据存储空间外，算法运行 还需要额外的存储空间。

# 三、支持动态扩容的顺序栈
实现支持动态扩容的栈，只需底层依赖一个支持动态扩容的数组即可。当栈满了之后，申请一个更大的数组，将原来的数据搬迁到新的数组中。
如图：
![](./images/1582977091847.png)
时间复杂度分析：
如图：
![](./images/1582977073077.png)
入栈的正常操作时间复杂度为 O(1)，支持动态扩容的顺序栈在扩容时，需要copy 原有数组所有数据，时间复杂度为 O(n)。
通过摊还分析法，支持动态扩容的顺序栈，入栈均摊时间复杂度为 O(1)。

> 均摊时间复杂度 一般都是等于最好情况时间复杂度。





# 四、栈在函数中的应用 - 函数调用栈
> 基础知识：操作系统给每个线程分配了一块儿独立的内存空间，这块内存被组织成“栈”这种结构，用来存储函数调用时的临时变量。每进入一个函数，就会将变量作为一个栈帧入栈，当被调用函数执行完成，返回之后，将这个函数对应的栈帧出栈。

例：
```java
int main() {
   int a = 1; 
   int ret = 0;
   int res = 0;
   ret = add(3, 5);
   res = a + ret;
   printf("%d", res);
   reuturn 0;
}

int add(int x, int y) {
   int sum = 0;
   sum = x + y;
   return sum;
}
```
本例中，main()函数调用了 add()函数，获取计算结果，并与临时变量 a 相加，打印res的值。
当执行到add()函数时，函数调用栈的情况如下图：
![](./images/1582977055611.png)

# 五、栈在表达式求值中的应用
表达式求值，编译器就是通过两个栈来实现。

## 表达式求值实现方法
其中一个保存**操作数的栈**，一个保存**运算符的栈**。
- 从左向右遍历表达式，遇到数字，直接压入操作数栈；
- 遇到运算符，与运算符栈的栈顶元素进行比较：
  - 如果比运算符栈顶元素的优先级高，直接压入栈；
  - 如果比运算符栈顶元素的优先级低，或相同，从运算符栈中取栈顶运算符，从操作数栈顶取 2 个操作数，然后进行计算，再把计算结果压入操作数栈，继续比较。

例：
```3 + 5 x 8 - 6```
计算过程如下图：
![](./images/1582977113293.png)
# 六、栈在括号匹配中的应用
可以借助 栈 来检查表达式中的括号是否匹配。

## 括号匹配实现方法
只需 1 个栈来保存未匹配的左括号，从左到右一次扫描字符串：
- 第1个是右括号，返回未匹配
- 扫描到左括号 直接压入栈中
- 扫描到右括号时，从栈顶取出一个左括号进行匹配
  - 如果能匹配，则继续扫描剩下字符串。如“(”跟“)”匹配，“[”跟“]”匹配
  - 如不能匹配，则返回未匹配
- 扫描过程中，当前扫描的是 右括号，且栈为空时，说明未匹配
- 扫描完成字符串后，如果栈为空，则说明字符串合法；否则存在未匹配的左括号，为非法。

假设括号可以任意嵌套
例：不合法括号`{[}()]`
图示如下：
![括号匹配中栈的应用](./images/括号匹配中栈的应用.png)

# 七、实现浏览器的前进和后退
使用两个栈，例如 X 、Y。
- 首次浏览的页面一次压入栈 X，点击后退按钮时，依次从栈 X 中出栈，并将出栈数据一次放入栈 Y。
- 当点击前进按钮，则一次从栈 Y中取出数据，放入栈X中。
- 当栈中没有数据，则说明无法前进或后退

# 内容小结
栈是一种操作受限的数据结构，只支持入栈和出栈操作。
后进先出是它最大的特点。
栈既可以通过数组实现，也可以通过链表来实现。
不管基于数组还是链表，入栈、出栈的时间复杂度都为 O(1)。
